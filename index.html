<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Fondo marino nostálgico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Sugerencias anti-caché para el navegador -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background:
        radial-gradient(circle at 10% 0%, #3f7f82 0%, #0b3a3e 35%, #020e10 80%),
        linear-gradient(to bottom, #083234, #020b0d);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .sea-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;

      /* Entrada elegante */
      opacity: 0;
      transform: translateY(8px);
      transition:
        opacity 0.7s ease-out,
        transform 0.7s ease-out;
    }

    .sea-container.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* ---------------------------------
       ALGAS
       --------------------------------- */
    .alga {
      position: absolute;
      object-fit: cover;
      pointer-events: none;
      transform-origin: 50% 100%; /* ancladas abajo */
      /* OJO: sin mask-image para evitar conflictos con iOS */
    }

    /* Fondo — blur + efecto agua */
    .alga-bg {
      z-index: 0;
    }

    /* Frente — efecto agua + puppet */
    .alga-fg {
      z-index: 2;
      filter: saturate(0.95) url(#agua-suave);
      animation: corrientePuppet 12s ease-in-out infinite;
    }

    /* Movimiento grupal de corriente */
    @keyframes corrientePuppet {
      0%   { transform: translateY(0px) rotate(0deg) skewX(0deg); }
      25%  { transform: translateY(-6px) rotate(0.5deg) skewX(1.5deg); }
      50%  { transform: translateY(-12px) rotate(1.2deg) skewX(3deg); }
      75%  { transform: translateY(-6px) rotate(0.4deg) skewX(1.5deg); }
      100% { transform: translateY(0px) rotate(0deg) skewX(0deg); }
    }

    /* ---------------------------------
       PARTÍCULAS EN EL AGUA
       --------------------------------- */
    .particles {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 3; /* sobre algas, bajo overlay */
      overflow: hidden;
    }

    .particle {
      position: absolute;
      border-radius: 999px;
      background: rgba(230, 245, 255, 0.7);
      mix-blend-mode: screen;
      opacity: 0.25;
      animation-name: floatParticle;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
      will-change: transform;
    }

    @keyframes floatParticle {
      0% {
        transform: translate3d(0, 0, 0);
      }
      100% {
        transform: translate3d(var(--dx, 0px), -120vh, 0);
      }
    }

    /* Overlay */
    .overlay {
      position: absolute;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(circle at 50% 15%, rgba(255,255,220,0.08) 0, transparent 55%),
        linear-gradient(to bottom, rgba(10,35,45,0.50), rgba(0,0,0,0.75));
      mix-blend-mode: soft-light;
      z-index: 4;
    }

    /* Grano */
    .grain {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.16;
      mix-blend-mode: soft-light;
      z-index: 5;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 160 160' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.9'/%3E%3C/svg%3E");
    }
  </style>
</head>

<body>
  <div class="sea-container" id="sea-container">
    <!-- Partículas flotando en el agua -->
    <div class="particles" id="particles-layer"></div>

    <div class="overlay"></div>
    <div class="grain"></div>
  </div>

  <!-- --------------------------
       FILTRO DE AGUA
       -------------------------- -->
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <filter id="agua-suave" x="0" y="0" width="100%" height="100%">
        <feTurbulence
            type="fractalNoise"
            baseFrequency="0.015 0.035"
            numOctaves="2"
            seed="4"
            result="noise">
          <animate attributeName="baseFrequency"
                   dur="14s"
                   values="0.015 0.035; 0.020 0.040; 0.015 0.035"
                   repeatCount="indefinite"/>
        </feTurbulence>

        <feDisplacementMap
            in="SourceGraphic"
            in2="noise"
            scale="10"
            xChannelSelector="R"
            yChannelSelector="G" />
      </filter>
    </defs>
  </svg>

  <!-- ------------------------------------
       JAVASCRIPT
       ------------------------------------ -->
  <script>
    const algaeSources = [
      "algas/algas 1.png",
      "algas/algas 2.png",
      "algas/algas 3.png",
      "algas/algas 4.png",
